1:"$Sreact.fragment"
2:I[5915,["173","static/chunks/173-e867bd8ccf023a5c.js","177","static/chunks/app/layout-119b86139f7d8ac3.js"],"default"]
3:I[8173,["173","static/chunks/173-e867bd8ccf023a5c.js","530","static/chunks/app/posts/page-ec37716daf67b3c5.js"],""]
4:I[2154,["173","static/chunks/173-e867bd8ccf023a5c.js","177","static/chunks/app/layout-119b86139f7d8ac3.js"],"default"]
5:I[5244,[],""]
6:I[3866,[],""]
8:I[6213,[],"OutletBoundary"]
a:I[6213,[],"MetadataBoundary"]
c:I[6213,[],"ViewportBoundary"]
e:I[4835,[],""]
:HL["/_next/static/media/569ce4b8f30dc480-s.p.woff2","font",{"crossOrigin":"","type":"font/woff2"}]
:HL["/_next/static/media/93f479601ee12b01-s.p.woff2","font",{"crossOrigin":"","type":"font/woff2"}]
:HL["/_next/static/css/f30152c0704fba31.css","style"]
:HL["/_next/static/css/d1a3066c6f88f288.css","style"]
:HL["/_next/static/css/574c065e7b12a953.css","style"]
:HL["/_next/static/css/d7a30530b49d87ef.css","style"]
0:{"P":null,"b":"949vXwtA1POpes2nz3ION","p":"","c":["","posts","250130-99",""],"i":false,"f":[[["",{"children":["posts",{"children":[["slug","250130-99","d"],{"children":["__PAGE__",{}]}]}]},"$undefined","$undefined",true],["",["$","$1","c",{"children":[[["$","link","0",{"rel":"stylesheet","href":"/_next/static/css/f30152c0704fba31.css","precedence":"next","crossOrigin":"$undefined","nonce":"$undefined"}],["$","link","1",{"rel":"stylesheet","href":"/_next/static/css/d1a3066c6f88f288.css","precedence":"next","crossOrigin":"$undefined","nonce":"$undefined"}],["$","link","2",{"rel":"stylesheet","href":"/_next/static/css/574c065e7b12a953.css","precedence":"next","crossOrigin":"$undefined","nonce":"$undefined"}]],["$","html",null,{"lang":"ko_KR","children":["$","body",null,{"className":"__variable_5cfdac __variable_9a8899 antialiased","children":[["$","$L2",null,{}],["$","div",null,{"children":["$","div",null,{"className":"header","children":[["$","div",null,{"children":["$","h1",null,{"children":["$","$L3",null,{"href":"/","children":"KoGandhi's World"}]}]}],["$","nav",null,{"className":"nav","children":["$","ul",null,{"children":[["$","li",null,{"children":["$","$L3",null,{"href":"/about","children":"About"}]}],["$","li",null,{"children":["$","$L3",null,{"href":"/posts","children":"Posts"}]}]]}]}]]}]}],["$","div",null,{"className":"mainField","children":[["$","$L4",null,{}],["$","$L5",null,{"parallelRouterKey":"children","segmentPath":["children"],"error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L6",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":[[],[["$","title",null,{"children":"404: This page could not be found."}],["$","div",null,{"style":{"fontFamily":"system-ui,\"Segoe UI\",Roboto,Helvetica,Arial,sans-serif,\"Apple Color Emoji\",\"Segoe UI Emoji\"","height":"100vh","textAlign":"center","display":"flex","flexDirection":"column","alignItems":"center","justifyContent":"center"},"children":["$","div",null,{"children":[["$","style",null,{"dangerouslySetInnerHTML":{"__html":"body{color:#000;background:#fff;margin:0}.next-error-h1{border-right:1px solid rgba(0,0,0,.3)}@media (prefers-color-scheme:dark){body{color:#fff;background:#000}.next-error-h1{border-right:1px solid rgba(255,255,255,.3)}}"}}],["$","h1",null,{"className":"next-error-h1","style":{"display":"inline-block","margin":"0 20px 0 0","padding":"0 23px 0 0","fontSize":24,"fontWeight":500,"verticalAlign":"top","lineHeight":"49px"},"children":404}],["$","div",null,{"style":{"display":"inline-block"},"children":["$","h2",null,{"style":{"fontSize":14,"fontWeight":400,"lineHeight":"49px","margin":0},"children":"This page could not be found."}]}]]}]}]]],"forbidden":"$undefined","unauthorized":"$undefined"}]]}],["$","div",null,{"className":"footer","children":[["$","p",null,{"className":"copyright","children":["© 2025 ",["$","span",null,{"children":"KoGandhi"}],". All rights reserved."]}],["$","p",null,{"className":"build","children":"Built with Next.js & Tailwind CSS"}],["$","p",null,{"className":"design","children":"Designed & Developed by KoGandhi"}],["$","p",null,{"className":"inspire","children":["Inspired by ",["$","span",null,{"className":"text-bold","children":"Minecraft"}]]}]]}]]}]}]]}],{"children":["posts",["$","$1","c",{"children":[null,["$","$L5",null,{"parallelRouterKey":"children","segmentPath":["children","posts","children"],"error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L6",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":"$undefined","forbidden":"$undefined","unauthorized":"$undefined"}]]}],{"children":[["slug","250130-99","d"],["$","$1","c",{"children":[null,["$","$L5",null,{"parallelRouterKey":"children","segmentPath":["children","posts","children","$0:f:0:1:2:children:2:children:0","children"],"error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L6",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":"$undefined","forbidden":"$undefined","unauthorized":"$undefined"}]]}],{"children":["__PAGE__",["$","$1","c",{"children":["$L7",[["$","link","0",{"rel":"stylesheet","href":"/_next/static/css/d7a30530b49d87ef.css","precedence":"next","crossOrigin":"$undefined","nonce":"$undefined"}]],["$","$L8",null,{"children":"$L9"}]]}],{},null,false]},null,false]},null,false]},null,false],["$","$1","h",{"children":[null,["$","$1","FIr_gNhF6wdtHRq-WUKZU",{"children":[["$","$La",null,{"children":"$Lb"}],["$","$Lc",null,{"children":"$Ld"}],["$","meta",null,{"name":"next-size-adjust","content":""}]]}]]}],false]],"m":"$undefined","G":["$e","$undefined"],"s":false,"S":true}
7:["$","div",null,{"children":[["$","div",null,{"className":"content-header","children":[["$","p",null,{"className":"content-category","children":"Security"}],["$","h1",null,{"className":"content-title","children":"레이스 컨디션 (Race Condition) & ToCToU"}],["$","p",null,{"className":"content-date","children":"2025.01.30"}]]}],["$","div",null,{"className":"md-content","children":[["$","h2","h2-0",{"children":"레이스 컨디션 (Race Condition)"}],"\n",["$","p","p-0",{"children":"두 개 이상의 프로세스 혹은 스레드가 공유 리소스(파일, 메모리 등)에 접근할 때, 실행 순서에 따라 예상하지 못한 결과가 발생하는 상황이다"}],"\n",["$","p","p-1",{"children":"실행 순서가 올바르게 제어되지 않으면 오류나 보안 취약점이 발생할 수 있다"}],"\n",["$","hr","hr-0",{}],"\n",["$","h3","h3-0",{"children":"Dreamhack - Race with me?"}],"\n",["$","p","p-2",{"children":["$","a","a-0",{"href":"https://dreamhack.io/wargame/challenges/1675","children":"https://dreamhack.io/wargame/challenges/1675"}]}],"\n",["$","p","p-3",{"children":"레이스 컨디션으로 인해 발생할 수 있는 보안 취약점을 활용하는 문제이다"}],"\n",["$","hr","hr-1",{}],"\n",["$","p","p-4",{"children":["$","img","img-0",{"src":"https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https%3A%2F%2Fblog.kakaocdn.net%2Fdn%2FEJIYq%2FbtsL1CsCgYL%2FpBHQ7eiIZCUp2PjgSzxAMk%2Fimg.png","alt":"External Image"}]}],"\n",["$","p","p-5",{"children":[["$","code","code-0",{"children":"Dockerfile"}],"과 함께 ",["$","code","code-1",{"children":"chall"}]," 파일이 주어지는데 ",["$","code","code-2",{"children":"stripped"}],"되어 있다"]}],"\n",["$","p","p-6",{"children":[["$","code","code-0",{"children":"stripped"}],"를 ",["$","code","code-1",{"children":"pwndbg"}],"로 디버깅해보려 했는데 쉽지 않아서 그냥 IDA 돌렸다"]}],"\n",["$","hr","hr-2",{}],"\n",["$","p","p-7",{"children":["$","img","img-0",{"src":"https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https%3A%2F%2Fblog.kakaocdn.net%2Fdn%2FbpaOVd%2FbtsL23wa2WW%2FGwRxtrs4AqNKu5fe9Kfsok%2Fimg.png","alt":"External Image"}]}],"\n",["$","p","p-8",{"children":"메뉴 4개가 주어진다"}],"\n",["$","p","p-9",{"children":"메뉴 설명을 통해서 대강 어떤 기능을 하는지 알 수 있다"}],"\n",["$","p","p-10",{"children":"4는 바이너리를 종료한다"}],"\n",["$","hr","hr-3",{}],"\n",["$","p","p-11",{"children":["$","img","img-0",{"src":"https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https%3A%2F%2Fblog.kakaocdn.net%2Fdn%2FbTACVv%2FbtsL1GI0Zpu%2FsAznHAYmIOuMnjinPbllJK%2Fimg.png","alt":"External Image"}]}],"\n",["$","p","p-12",{"children":["1로 ",["$","code","code-0",{"children":"input"}],"에 데이터를 입력할 수 있다"]}],"\n",["$","p","p-13",{"children":["2는 ",["$","code","code-0",{"children":"pthread"}],"로 새로운 스레드를 실행한다"]}],"\n",["$","p","p-14",{"children":[["$","code","code-0",{"children":"corres"}]," 변수가 ",["$","code","code-1",{"children":"0xdeadbeef"}],"와 일치하면 플래그를 출력해준다"]}],"\n",["$","hr","hr-4",{}],"\n",["$","p","p-15",{"children":["$","img","img-0",{"src":"https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https%3A%2F%2Fblog.kakaocdn.net%2Fdn%2FlXAAl%2FbtsL2IeLprn%2FPQGnoMwGVytTyUxsRQiwik%2Fimg.png","alt":"External Image"}]}],"\n",["$","p","p-16",{"children":"2번 메뉴에서 생성된 스레드가 동작하는 함수이다"}],"\n",["$","p","p-17",{"children":["10초가 지나면 ",["$","code","code-0",{"children":"corres"}]," 변수에 ",["$","code","code-1",{"children":"input"}],"으로 입력했던 값이 대입된다"]}],"\n",["$","p","p-18",{"children":"여기서 레이스 컨디션으로 인한 취약점이 있다"}],"\n",["$","p","p-19",{"children":["새로운 스레드를 만들고 10초가 지나기 전에 메뉴 1을 통해서 ",["$","code","code-0",{"children":"input"}]," 값을 ",["$","code","code-1",{"children":"0xdeadbeef"}],"로 설정하고 10초가 지나면 ",["$","code","code-2",{"children":"corres"}]," 에 ",["$","code","code-3",{"children":"input"}],"의 값이 대입된다"]}],"\n",["$","p","p-20",{"children":"후에 메뉴 3을 사용하면 조건을 만족해 플래그를 출력하게 된다"}],"\n",["$","p","p-21",{"children":"더보기"}],"\n",["$","p","p-22",{"children":["스레드는 독립적인 스택을 사용하기 때문에 스레드를 생성하기 전에 메뉴 1로 ",["$","code","code-0",{"children":"input"}]," 값을 설정해도 새로운 스레드에서는 ",["$","code","code-1",{"children":"input"}]," 값이 ",["$","code","code-2",{"children":"NULL"}],"이다"]}],"\n",["$","p","p-23",{"children":["때문에 새로운 스레드를 생성한 후에 메뉴 1로 ",["$","code","code-0",{"children":"input"}]," 값을 설정해준 것이다"]}],"\n",["$","hr","hr-5",{}],"\n",["$","pre","pre-0",{"className":"language-python","children":["$","code","code-0",{"className":"language-python","children":[["$","span","span-0",{"className":"token keyword","children":"from"}]," pwn ",["$","span","span-1",{"className":"token keyword","children":"import"}]," ",["$","span","span-2",{"className":"token operator","children":"*"}],"\n\nport ",["$","span","span-3",{"className":"token operator","children":"="}]," ",["$","span","span-4",{"className":"token number","children":"00000"}],"\np ",["$","span","span-5",{"className":"token operator","children":"="}]," remote",["$","span","span-6",{"className":"token punctuation","children":"("}],["$","span","span-7",{"className":"token string","children":"'host1.dreamhack.games'"}],["$","span","span-8",{"className":"token punctuation","children":","}]," port",["$","span","span-9",{"className":"token punctuation","children":")"}],"\n\np",["$","span","span-10",{"className":"token punctuation","children":"."}],"sendlineafter",["$","span","span-11",{"className":"token punctuation","children":"("}],["$","span","span-12",{"className":"token string","children":"b'Input: '"}],["$","span","span-13",{"className":"token punctuation","children":","}]," ",["$","span","span-14",{"className":"token string","children":"b'2'"}],["$","span","span-15",{"className":"token punctuation","children":")"}],"\np",["$","span","span-16",{"className":"token punctuation","children":"."}],"sendlineafter",["$","span","span-17",{"className":"token punctuation","children":"("}],["$","span","span-18",{"className":"token string","children":"b'Input: '"}],["$","span","span-19",{"className":"token punctuation","children":","}]," ",["$","span","span-20",{"className":"token string","children":"b'1'"}],["$","span","span-21",{"className":"token punctuation","children":")"}],"\np",["$","span","span-22",{"className":"token punctuation","children":"."}],"sendlineafter",["$","span","span-23",{"className":"token punctuation","children":"("}],["$","span","span-24",{"className":"token string","children":"b'Input: '"}],["$","span","span-25",{"className":"token punctuation","children":","}]," ",["$","span","span-26",{"className":"token string","children":"b'3735928559'"}],["$","span","span-27",{"className":"token punctuation","children":")"}],"\n\ntime",["$","span","span-28",{"className":"token punctuation","children":"."}],"sleep",["$","span","span-29",{"className":"token punctuation","children":"("}],["$","span","span-30",{"className":"token number","children":"10"}],["$","span","span-31",{"className":"token punctuation","children":")"}],"\n\np",["$","span","span-32",{"className":"token punctuation","children":"."}],"sendlineafter",["$","span","span-33",{"className":"token punctuation","children":"("}],["$","span","span-34",{"className":"token string","children":"b'Input: '"}],["$","span","span-35",{"className":"token punctuation","children":","}]," ",["$","span","span-36",{"className":"token string","children":"b'3'"}],["$","span","span-37",{"className":"token punctuation","children":")"}],"\n",["$","span","span-38",{"className":"token keyword","children":"print"}],["$","span","span-39",{"className":"token punctuation","children":"("}],"p",["$","span","span-40",{"className":"token punctuation","children":"."}],"recvline",["$","span","span-41",{"className":"token punctuation","children":"("}],["$","span","span-42",{"className":"token punctuation","children":")"}],["$","span","span-43",{"className":"token punctuation","children":"."}],"decode",["$","span","span-44",{"className":"token punctuation","children":"("}],["$","span","span-45",{"className":"token punctuation","children":")"}],["$","span","span-46",{"className":"token punctuation","children":")"}],"\n"]}]}],"\n",["$","p","p-24",{"children":["$","img","img-0",{"src":"https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https%3A%2F%2Fblog.kakaocdn.net%2Fdn%2FpbX29%2FbtsL1igRi5B%2FtkpiiKZz7iQF8ntSzhUjs1%2Fimg.png","alt":"External Image"}]}],"\n",["$","hr","hr-6",{}],"\n",["$","h3","h3-1",{"children":"TOCTOU (Time-Of-Check to Tiime-Of-Use)"}],"\n",["$","p","p-25",{"children":"레이스 컨디션을 이용한 보안 취약점 중 하나이다"}],"\n",["$","p","p-26",{"children":"앞서 봤던 드림핵 문제에서도 확인할 수 있다"}],"\n",["$","hr","hr-7",{}],"\n",["$","pre","pre-1",{"className":"language-c","children":["$","code","code-0",{"className":"language-c","children":[["$","span","span-0",{"className":"token keyword","children":"if"}]," ",["$","span","span-1",{"className":"token punctuation","children":"("}],["$","span","span-2",{"className":"token function","children":"access"}],["$","span","span-3",{"className":"token punctuation","children":"("}],["$","span","span-4",{"className":"token string","children":"\"file.txt\""}],["$","span","span-5",{"className":"token punctuation","children":","}]," W_OK",["$","span","span-6",{"className":"token punctuation","children":")"}]," ",["$","span","span-7",{"className":"token operator","children":"=="}]," ",["$","span","span-8",{"className":"token number","children":"0"}],["$","span","span-9",{"className":"token punctuation","children":")"}]," ",["$","span","span-10",{"className":"token punctuation","children":"{"}]," ",["$","span","span-11",{"className":"token comment","children":"// 파일 쓰기 가능 여부 확인"}],"\n\tfd ",["$","span","span-12",{"className":"token operator","children":"="}]," ",["$","span","span-13",{"className":"token function","children":"open"}],["$","span","span-14",{"className":"token punctuation","children":"("}],["$","span","span-15",{"className":"token string","children":"\"file.txt\""}],["$","span","span-16",{"className":"token punctuation","children":","}]," O_WRONLY",["$","span","span-17",{"className":"token punctuation","children":")"}],["$","span","span-18",{"className":"token punctuation","children":";"}]," ",["$","span","span-19",{"className":"token comment","children":"// 파일 열기"}],"\n\t",["$","span","span-20",{"className":"token function","children":"write"}],["$","span","span-21",{"className":"token punctuation","children":"("}],"fd",["$","span","span-22",{"className":"token punctuation","children":","}]," ",["$","span","span-23",{"className":"token string","children":"\"data\""}],["$","span","span-24",{"className":"token punctuation","children":","}]," ",["$","span","span-25",{"className":"token number","children":"4"}],["$","span","span-26",{"className":"token punctuation","children":")"}],["$","span","span-27",{"className":"token punctuation","children":";"}]," ",["$","span","span-28",{"className":"token comment","children":"// 데이터 쓰기"}],"\n",["$","span","span-29",{"className":"token punctuation","children":"}"}],"\n"]}]}],"\n",["$","p","p-27",{"children":[["$","code","code-0",{"children":"file.txt"}],"에 write permission이 있으면 파일을 열어 데이터를 쓰는 코드이다"]}],"\n",["$","p","p-28",{"children":["만약 ",["$","code","code-0",{"children":"access"}]," 함수가 실행되고 ",["$","code","code-1",{"children":"open"}]," 함수가 실행되기 전에 ",["$","code","code-2",{"children":"file.txt"}]," 파일의 이름을 ",["$","code","code-3",{"children":"/etc/passwd"}]," 등 심볼릭 링크로 변경할 수 있다"]}],"\n",["$","p","p-29",{"children":["이렇게 되면 ",["$","code","code-0",{"children":"open"}]," 함수는 ",["$","code","code-1",{"children":"/etc/passwd"}],"를 열게 되면서 시스템 파일을 덮어쓸 수 있게 된다"]}],"\n",["$","p","p-30",{"children":"이처럼 검사(TOC)와 사용(TOU) 사이에 상태가 변하는 문제가 레이스 컨디션을 유발하게 된다"}],"\n",["$","hr","hr-8",{}],"\n",["$","h3","h3-2",{"children":"레이스 컨디션 방지"}],"\n",["$","h4","h4-0",{"children":"동기화(Synchronization) 기법"}],"\n",["$","ul","ul-0",{"children":["\n",["$","li","li-0",{"children":"뮤텍스 **(Mutex)**를 사용해 한 번에 하나의 프로세스 또는 스레드만 공유 리소스에 접근하도록 제한할 수 있다"}],"\n",["$","li","li-1",{"children":"세마포어 **(Semaphore)**로 공유 리소스에 접근 가능한 최대 프로세스 또는 스레드의 수를 제한할 수 있다"}],"\n",["$","li","li-2",{"children":[["$","strong","strong-0",{"children":"Atomic Operations"}],"를 이용해 중간에 인터셉트 없이 한번에 수행되는 연산을 사용할 수 있다"]}],"\n"]}],"\n",["$","h4","h4-1",{"children":"임시 파일 사용 시 보안 강화"}],"\n",["$","ul","ul-1",{"children":["\n",["$","li","li-0",{"children":[["$","code","code-0",{"children":"O_EXCL"}],"옵션을 사용해 이미 존재하는 파일을 덮어쓰지 않도록 한다"]}],"\n",["$","li","li-1",{"children":["/tmp 디렉터리 내에서 파일을 생성할 때 ",["$","code","code-0",{"children":"mkstemp()"}]," 함수를 사용한다"]}],"\n"]}],"\n",["$","h4","h4-2",{"children":"권한 변경 시 안전한 방법 사용"}],"\n",["$","ul","ul-2",{"children":["\n",["$","li","li-0",{"children":[["$","code","code-0",{"children":"chmod()"}],"를 사용하기 전 파일의 소유자가 변경되었는지 확인하는 로직을 추가할 수 있다"]}],"\n",["$","li","li-1",{"children":[["$","code","code-0",{"children":"open()"}],"과 ",["$","code","code-1",{"children":"chmod()"}],"를 연속적으로 실행하지 않고 ",["$","code","code-2",{"children":"fchmod()"}],"를 사용해 파일 디스크립터를 직접 수행할 수 있다"]}],"\n"]}]]}]]}]
d:[["$","meta","0",{"name":"viewport","content":"width=device-width, initial-scale=1"}]]
b:[["$","meta","0",{"charSet":"utf-8"}],["$","title","1",{"children":"KoGandhi's World"}],["$","meta","2",{"name":"description","content":"Welcome to visit my place"}]]
9:null
